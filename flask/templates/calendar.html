<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Shared Saints – Feast Calendar</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        margin: 0;
        padding: 1.5rem;
        background: #f5f5f8;
      }

      .top-nav {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        align-items: center;
        flex-wrap: wrap;
      }

      .top-nav a {
        text-decoration: none;
        font-size: 0.9rem;
        color: #444;
      }

      .toggle-group {
        display: inline-flex;
        border-radius: 999px;
        background: #e2e2ee;
        padding: 0.15rem;
      }

      .toggle-group button {
        border: none;
        padding: 0.4rem 0.9rem;
        font-size: 0.9rem;
        cursor: pointer;
        background: transparent;
        border-radius: 999px;
      }

      .toggle-group button.active {
        background: white;
        box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      }

      h1 {
        margin-top: 0;
        margin-bottom: 0.5rem;
        font-size: 1.4rem;
      }

      .subtitle {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 1.5rem;
      }

      /* Shared view container behavior */
      .view {
        display: none;
      }
      .view.active {
        display: block;
      }

      /* ---- Calendar (grid) view styles ---- */

      .month-card {
        margin-bottom: 1.5rem;
        background: white;
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        box-shadow: 0 1px 4px rgba(0,0,0,0.06);
      }

      .month-card h2 {
        font-size: 1rem;
        margin: 0 0 0.75rem 0;
      }

      .month-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.5rem;
      }

      .day-cell {
        border-radius: 0.6rem;
        background: #f8f8ff;
        padding: 0.4rem 0.5rem;
        min-height: 3.2rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      }

      .day-number {
        font-size: 0.85rem;
        font-weight: 700;
        color: #555;
        margin-bottom: 0.25rem;
      }

      .day-saint-name {
        font-size: 0.82rem;
        font-weight: 600;
      }

      .day-saint-extra {
        font-size: 0.75rem;
        color: #777;
      }

      /* ---- List view styles (your old layout) ---- */

      .month-list {
        margin-bottom: 1.5rem;
        background: white;
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        box-shadow: 0 1px 4px rgba(0,0,0,0.06);
      }

      .month-list h2 {
        font-size: 1rem;
        margin: 0 0 0.5rem 0;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
      }

      td {
        vertical-align: top;
        padding: 0.25rem 0;
      }

      td:first-child {
        width: 3rem;
        font-weight: 600;
        color: #555;
      }

      .saint-name {
        font-weight: 600;
      }

      .saint-summary {
        font-size: 0.8rem;
        color: #666;
      }

      .saint-row + .saint-row {
        margin-top: 0.25rem;
      }
    </style>
  </head>
  <body>
    <div class="top-nav">
      <!-- Back to wheel -->
      <a href="{{ url_for('index') }}">← Back to Wheel</a>

      <!-- Tradition toggle -->
      <form method="get" class="toggle-group">
        <button
          type="submit"
          name="tradition"
          value="orthodox"
          class="{% if tradition == 'orthodox' %}active{% endif %}"
        >
          Orthodox
        </button>
        <button
          type="submit"
          name="tradition"
          value="catholic"
          class="{% if tradition == 'catholic' %}active{% endif %}"
        >
          Catholic
        </button>
      </form>

      <!-- View toggle (Calendar vs List) -->
      <div class="toggle-group">
        <button type="button" id="btn-calendar" class="active">
          Calendar
        </button>
        <button type="button" id="btn-list">
          List
        </button>
      </div>
    </div>

    <h1>Shared Pre-Schism Saints – Feast Calendar</h1>
    <div class="subtitle">
      Currently showing the
      <strong>{{ tradition.capitalize() }}</strong>
      feast dates (primary date for each saint).
      Use the toggle to switch between a calendar-style grid and a detailed list.
    </div>

    <!-- ===== CALENDAR VIEW (DEFAULT) ===== -->
    <div id="calendar-view" class="view active">
      {% for month in month_data %}
        <section class="month-card">
          <h2>{{ month.name }}</h2>
          <div class="month-grid">
            {% for day, saints in month.days %}
              <div class="day-cell">
                <div class="day-number">{{ "%02d"|format(day) }}</div>
                {% for s in saints %}
                  <div class="day-saint">
                    <div class="day-saint-name">{{ s.name }}</div>
                    {% if s.summary %}
                      <div class="day-saint-extra">
                        {{ s.summary[:80] }}{% if s.summary|length > 80 %}…{% endif %}
                      </div>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            {% endfor %}
          </div>
        </section>
      {% endfor %}
    </div>

    <!-- ===== LIST VIEW (YOUR ORIGINAL TABLE) ===== -->
    <div id="list-view" class="view">
      {% for month in month_data %}
        <section class="month-list">
          <h2>{{ month.name }}</h2>
          <table>
            <tbody>
              {% for day, saints in month.days %}
                <tr>
                  <td>{{ "%02d"|format(day) }}</td>
                  <td>
                    {% for s in saints %}
                      <div class="saint-row">
                        <span class="saint-name">{{ s.name }}</span>
                        {% if s.summary %}
                          <div class="saint-summary">
                            {{ s.summary }}
                          </div>
                        {% endif %}
                      </div>
                    {% endfor %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </section>
      {% endfor %}
    </div>

    <script>
      const calendarBtn = document.getElementById("btn-calendar");
      const listBtn = document.getElementById("btn-list");
      const calendarView = document.getElementById("calendar-view");
      const listView = document.getElementById("list-view");

      function setView(view) {
        if (view === "calendar") {
          calendarView.classList.add("active");
          listView.classList.remove("active");
          calendarBtn.classList.add("active");
          listBtn.classList.remove("active");
        } else {
          calendarView.classList.remove("active");
          listView.classList.add("active");
          calendarBtn.classList.remove("active");
          listBtn.classList.add("active");
        }
      }

      calendarBtn.addEventListener("click", () => setView("calendar"));
      listBtn.addEventListener("click", () => setView("list"));

      // Default to calendar view when the page loads
      setView("calendar");
    </script>
  </body>
</html>
